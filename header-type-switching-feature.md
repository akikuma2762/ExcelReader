# 🆕 Excel 標頭類型切換功能

## 📋 功能概述

我們發現了一個重要的改進點：Excel 讀取器現在提供了兩種標頭顯示模式，讓使用者可以根據需求選擇最適合的標頭類型。

## 🔧 問題背景

原本的系統將 Excel 的第一行內容（如合併儲存格的標題）作為表格標頭，但在某些情況下，使用者更希望看到傳統的 Excel 欄位標頭（A、B、C、D...）。

**問題範例：**
- 原始第一行：`"deta International德大機械股份有限公司"`（合併儲存格 A1:M1）
- 使用者期望：`A, B, C, D, E, F, G, H, I, J, K, L, M`

## ✨ 新功能特色

### 🎛️ 雙重標頭模式
1. **Excel 欄位標頭** (預設)
   - 顯示傳統的 Excel 欄位名稱：A、B、C、D、E...
   - 藍色背景，白色文字，清晰易讀
   - 適合資料分析和程式設計用途

2. **工作表內容標頭**
   - 顯示 Excel 第一行的實際內容
   - 保留所有格式資訊（字體、顏色、邊框、合併儲存格等）
   - 適合展示原始文件格式

### 🎨 使用者介面
- **標頭類型選擇器**：下拉式選單，方便切換
- **即時切換**：選擇後立即生效，無需重新載入
- **視覺區分**：兩種標頭有不同的樣式設計

## 🔄 後端改進

### API 回應結構變更
```json
{
  "headers": [
    ["A", "B", "C", "D", "E", "F", "G"],           // 0: Excel 欄位標頭
    [                                                // 1: 工作表內容標頭
      {
        "value": "deta International德大機械股份有限公司",
        "position": {"address": "A1"},
        "dimensions": {"colSpan": 13},
        // ... 完整格式資訊
      },
      // ... 其他欄位
    ]
  ]
}
```

### 新增功能
- **GetColumnName 方法**：將數字轉換為 Excel 欄位名稱
  - `1` → `A`
  - `26` → `Z`  
  - `27` → `AA`
  - `702` → `ZZ`

## 💡 使用場景

### 📊 資料分析師模式
選擇「Excel 欄位標頭」，適用於：
- 資料分析和處理
- 程式開發和偵錯
- API 測試和驗證
- 資料庫匯入

### 📄 文件展示模式  
選擇「工作表內容標頭」，適用於：
- 保持原始文件格式
- 展示給客戶或主管
- 列印或匯出用途
- Rich Text 格式展示

## 🎯 技術實現

### 前端 (Vue.js)
```typescript
// 響應式標頭類型
const headerType = ref<'column' | 'content'>('column')

// 智慧標頭選擇
const getCurrentHeaders = () => {
  if (headerType.value === 'column') {
    return excelData.value.headers[0] // Excel 欄位標頭
  } else {
    return excelData.value.headers[1] // 工作表內容標頭
  }
}
```

### 後端 (.NET)
```csharp
// 生成 Excel 欄位標頭
private string GetColumnName(int columnNumber)
{
    string columnName = "";
    while (columnNumber > 0)
    {
        columnNumber--;
        columnName = (char)('A' + columnNumber % 26) + columnName;
        columnNumber /= 26;
    }
    return columnName;
}
```

## 📱 響應式設計

- **選擇器樣式**：現代化下拉式選單，支援鍵盤導覽
- **標頭樣式**：
  - Excel 欄位標頭：藍色背景，粗體文字
  - 內容標頭：保留原始格式，支援合併儲存格
- **焦點狀態**：清晰的焦點指示器，提升使用體驗

## 🔮 預期效果

### 使用者體驗提升
- **靈活性**：根據使用場景選擇最適合的標頭模式
- **專業性**：資料分析時使用傳統 Excel 欄位標頭
- **視覺化**：文件展示時保留原始格式

### 技術優勢
- **向後相容**：原有功能完全保留
- **效能最佳化**：前端即時切換，無需重新請求
- **可擴展性**：為未來新增更多標頭類型預留空間

## 🧪 測試建議

1. **基本功能測試**
   - 上傳包含合併儲存格標題的 Excel 檔案
   - 切換標頭類型，驗證顯示效果
   - 檢查 Excel 欄位標頁（A, B, C...）是否正確生成

2. **格式保留測試**
   - 驗證內容標頭模式下的格式完整性
   - 測試 Rich Text、合併儲存格等複雜格式
   - 確認邊框、顏色、字體等視覺效果

3. **使用者介面測試**
   - 下拉選單的可用性和可訪問性
   - 即時切換的反應速度
   - 不同螢幕尺寸下的顯示效果

這個新功能完美解決了您提到的問題，讓 Excel Reader 更加靈活和實用！ 🎉