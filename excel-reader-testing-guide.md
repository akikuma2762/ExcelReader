# Excel Reader 新功能測試指南

## 測試用 Excel 檔案建議

為了充分測試新功能，建議創建包含以下內容的 Excel 檔案：

### 1. 字體樣式測試
- **粗體文字**: 測試 `font.bold`
- *斜體文字*: 測試 `font.italic`
- ~~刪除線文字~~: 測試 `font.strike`
- 不同字體: Arial, Times New Roman, 微軟正黑體
- 不同大小: 8pt, 12pt, 16pt, 20pt
- 不同顏色: 紅、藍、綠、自訂顏色

### 2. 對齊方式測試
- 水平對齊: 靠左、置中、靠右、分散對齊
- 垂直對齊: 靠上、置中、靠下
- 自動換行文字
- 文字縮排

### 3. 邊框樣式測試
- 細線邊框
- 粗線邊框
- 虛線邊框
- 點線邊框
- 雙線邊框
- 不同顏色邊框

### 4. 背景和填充測試
- 純色背景
- 不同顏色背景
- 圖案填充 (如果支援)

### 5. Rich Text 測試
在單一儲存格中包含：
- **粗體** + *斜體* + 正常文字
- 不同顏色的文字片段
- 不同大小的文字片段

### 6. 合併儲存格測試
- 橫向合併 (2x1, 3x1, 4x1)
- 縱向合併 (1x2, 1x3, 1x4)
- 矩形合併 (2x2, 3x3)

### 7. 公式測試
- 簡單公式: =A1+B1
- 複雜公式: =SUM(A1:A10)
- 函數公式: =TODAY(), =NOW()

### 8. 註解測試
- 包含註解的儲存格
- 不同作者的註解
- 多行註解內容

### 9. 超連結測試
- 外部網址連結
- 電子郵件連結
- 檔案連結

### 10. 數字格式測試
- 貨幣格式
- 百分比格式
- 日期格式
- 時間格式
- 自訂格式

## 前端測試步驟

### 1. 基本功能測試
1. 啟動前端應用
2. 上傳測試 Excel 檔案
3. 驗證基本顯示功能

### 2. 新功能測試

#### 進階格式顯示
1. 勾選「顯示進階格式」選項
2. 驗證邊框是否正確顯示
3. 檢查字體裝飾效果
4. 確認對齊方式應用

#### 位置資訊顯示
1. 勾選「顯示位置資訊」選項
2. 驗證儲存格地址顯示
3. 檢查公式是否正確顯示
4. 確認位置資訊不影響主要內容

#### 工具提示測試
1. 滑鼠懸停在不同類型的儲存格上
2. 驗證工具提示顯示完整資訊：
   - 位置資訊
   - 資料類型
   - 格式資訊
   - 字體資訊
   - 對齊資訊
   - Rich Text 資訊
   - 合併儲存格資訊
   - 註解和超連結資訊

### 3. 相容性測試
1. 使用舊版 API 格式的資料
2. 確認向後相容性
3. 驗證舊屬性仍然有效

## 後端測試

### Debug API 測試
1. 調用 `/api/excel/debug-raw-data` 端點
2. 驗證返回完整的 EPPlus 屬性資訊
3. 檢查所有新增的屬性結構

### 模型映射測試
1. 驗證舊屬性到新屬性的映射
2. 確認 `[Obsolete]` 屬性仍然有效
3. 測試新屬性的完整性

## 效能測試

### 大檔案測試
1. 上傳大型 Excel 檔案 (1000+ 行)
2. 測試渲染效能
3. 驗證記憶體使用情況

### 複雜格式測試
1. 上傳包含複雜格式的檔案
2. 測試樣式計算效能
3. 驗證 UI 響應性

## 預期結果

### ✅ 成功標準
- 所有格式正確顯示
- 新功能選項正常工作
- 工具提示資訊完整
- 效能沒有明顯下降
- 向後相容性保持

### ❌ 失敗指標
- 格式顯示錯誤
- 功能選項無效
- 工具提示資訊不完整
- 效能嚴重下降
- 向後相容性破壞

## 問題排查

### 常見問題
1. **樣式不顯示**: 檢查「顯示進階格式」選項
2. **邊框消失**: 驗證 CSS 邊框樣式轉換
3. **工具提示空白**: 檢查資料完整性
4. **效能問題**: 檢查樣式計算邏輯

### 除錯工具
- 瀏覽器開發者工具
- Vue DevTools
- 後端 Debug API
- Console 日誌

## 回歸測試

在每次修改後，確保執行：
1. 基本上傳功能
2. 格式保留功能
3. Rich Text 顯示
4. 合併儲存格處理
5. 所有新增功能