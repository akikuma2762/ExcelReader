# 新功能：下載 JSON 按鈕

## 功能描述

新增了一個「下載 JSON」按鈕，讓使用者可以將Excel讀取後的資料以JSON格式下載到本地。

## 功能特色

### ✨ 智慧檔名生成
- 自動使用原Excel檔案名稱作為JSON檔案名稱基礎
- 格式：`原檔名.json` (例如：`員工資料.xlsx` → `員工資料.json`)
- 如果沒有原檔名，則使用預設名稱：`excel-data.json`

### 🎛️ 使用者體驗
- **按鈕狀態管理**：沒有資料時按鈕會被禁用
- **視覺回饋**：下載成功會顯示成功訊息
- **錯誤處理**：下載失敗會顯示錯誤訊息
- **按鈕樣式**：綠色按鈕，與其他下載按鈕保持一致

### 📱 響應式設計
- 按鈕群組使用flexbox布局
- 支援小螢幕自動換行
- 與顯示/隱藏JSON按鈕並排顯示

## 技術實現

### 前端功能
```typescript
const downloadJson = () => {
  // 1. 檢查資料是否存在
  // 2. 創建JSON Blob
  // 3. 生成下載連結
  // 4. 智慧檔名處理
  // 5. 觸發下載
  // 6. 清理資源
  // 7. 顯示結果訊息
}
```

### CSS 樣式
- `.json-controls`: 按鈕容器樣式
- `.download-json-btn`: 下載按鈕樣式
- 禁用狀態和懸停效果

## 使用方式

1. **上傳Excel檔案**：先上傳並解析Excel檔案
2. **點擊下載按鈕**：在JSON資料區域點擊「下載 JSON」
3. **檔案自動下載**：瀏覽器會自動下載JSON檔案到預設下載資料夾

## 下載的JSON內容

JSON檔案包含完整的Excel資料結構：

```json
{
  "fileName": "範例檔案.xlsx",
  "worksheetName": "Sheet1", 
  "totalRows": 10,
  "totalColumns": 5,
  "headers": [...],
  "rows": [...],
  "availableWorksheets": ["Sheet1"],
  "worksheetInfo": {...}
}
```

### 包含的詳細資訊：
- **基本資訊**：檔案名、工作表名、行列數
- **標題資料**：第一行作為表頭
- **內容資料**：所有資料行
- **格式資訊**：字體、顏色、對齊、邊框等完整格式
- **結構資訊**：合併儲存格、Rich Text、公式等
- **中繼資料**：位置、類型、樣式等詳細屬性

## 應用場景

### 📊 資料分析
- 將Excel資料匯出為JSON供其他工具分析
- 整合到資料處理管道
- 製作資料備份

### 🔧 開發除錯
- 檢查Excel解析結果
- 驗證格式保留情況
- API整合測試

### 📁 資料交換
- 跨平台資料交換
- 與其他系統整合
- 資料格式轉換

## 錯誤處理

### 常見錯誤情況：
- **無資料**：顯示「沒有可下載的資料」
- **下載失敗**：顯示具體錯誤訊息
- **檔名處理**：自動處理特殊字符

### 防護機制：
- 按鈕禁用狀態防止無效操作
- try-catch 錯誤捕獲
- 記憶體清理防止洩漏

## 技術規格

- **檔案格式**：UTF-8編碼的JSON
- **MIME類型**：`application/json`
- **下載方式**：瀏覽器原生下載API
- **相容性**：支援所有現代瀏覽器

這個新功能讓Excel Reader更加實用，使用者可以輕鬆將處理後的資料用於其他用途！